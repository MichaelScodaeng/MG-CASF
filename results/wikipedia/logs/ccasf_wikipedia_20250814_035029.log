2025-08-14 03:50:29,885 - INFO - Starting experiment: ccasf_clifford on wikipedia
2025-08-14 03:50:29,885 - INFO - Device: cuda
2025-08-14 03:50:29,885 - INFO - 
==================================================
2025-08-14 03:50:29,885 - INFO - Run 1/5
2025-08-14 03:50:29,885 - INFO - ==================================================
2025-08-14 03:50:29,888 - INFO - Starting training for wikipedia with C-CASF
2025-08-14 03:50:29,888 - INFO - Configuration: {'dataset_name': 'wikipedia', 'model_name': 'DyGMamba_CCASF', 'use_ccasf': True, 'spatial_dim': 64, 'temporal_dim': 64, 'ccasf_output_dim': 128, 'node_feat_dim': 172, 'edge_feat_dim': 172, 'fusion_method': 'clifford', 'weighted_fusion_learnable': True, 'mlp_hidden_dim': None, 'mlp_num_layers': 2, 'use_rpearl': True, 'use_enhanced_lete': True, 'rpearl_k': 16, 'rpearl_mlp_layers': 2, 'rpearl_hidden': 64, 'lete_p': 0.5, 'lete_layer_norm': True, 'lete_scale': True, 'time_feat_dim': 100, 'channel_embedding_dim': 100, 'patch_size': 2, 'num_layers': 2, 'num_heads': 2, 'dropout': 0.1, 'gamma': 0.5, 'max_input_sequence_length': 64, 'max_interaction_times': 10, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'patience': 20, 'num_epochs': 100, 'batch_size': 200, 'eval_batch_size': 200, 'test_batch_size': 200, 'val_ratio': 0.15, 'test_ratio': 0.15, 'negative_sample_strategy': 'random', 'num_neighbors': 20, 'num_runs': 5, 'load_best_configs': False, 'device': 'cuda', 'num_workers': 8, 'seed': 0, 'data_root': '/home/s2516027/GLCE/processed_data', 'output_root': '/home/s2516027/GLCE/results', 'checkpoint_dir': '/home/s2516027/GLCE/checkpoints', 'log_every': 1, 'eval_every': 5, 'save_model': True, 'verbose': True}
2025-08-14 03:50:29,888 - INFO - Loading wikipedia dataset...
2025-08-14 03:50:30,312 - INFO - Number of nodes: 9228
2025-08-14 03:50:30,312 - INFO - Number of edges: 157475
2025-08-14 03:50:30,312 - INFO - Node feature dimension: 172
2025-08-14 03:50:30,313 - INFO - Edge feature dimension: 172
2025-08-14 03:50:30,313 - INFO - Training interactions: 79202
2025-08-14 03:50:30,313 - INFO - Validation interactions: 23621
2025-08-14 03:50:30,313 - INFO - Test interactions: 23621
2025-08-14 03:50:30,455 - INFO - Creating DyGMamba with C-CASF integration...
2025-08-14 03:50:30,455 - ERROR - Error creating model
Traceback (most recent call last):
  File "/home/s2516027/GLCE/DyGMamba/train_ccasf_link_prediction.py", line 85, in create_model
    model = DyGMamba_CCASF(
            ^^^^^^^^^^^^^^^
TypeError: DyGMamba_CCASF.__init__() got an unexpected keyword argument 'fusion_method'
2025-08-14 03:50:30,455 - INFO - Falling back to original DyGMamba...
2025-08-14 03:50:30,692 - INFO - Fallback model created with 913995 parameters
2025-08-14 03:51:09,633 - ERROR - Error in evaluation batch 0
Traceback (most recent call last):
  File "/home/s2516027/GLCE/DyGMamba/train_ccasf_link_prediction.py", line 224, in evaluate_model
    neg_result = model.compute_src_dst_node_temporal_embeddings(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s2516027/GLCE/DyGMamba/models/DyGMamba.py", line 143, in compute_src_dst_node_temporal_embeddings
    self.neighbor_sampler.get_all_first_hop_neighbors(node_ids=dst_node_ids, node_interact_times=node_interact_times)
  File "/home/s2516027/GLCE/DyGMamba/utils/utils.py", line 271, in get_all_first_hop_neighbors
    node_neighbor_ids, node_edge_ids, node_neighbor_times, _ = self.find_neighbors_before(node_id=node_id,
                                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s2516027/GLCE/DyGMamba/utils/utils.py", line 145, in find_neighbors_before
    i = np.searchsorted(self.nodes_neighbor_times[node_id], interact_time)
                        ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
IndexError: list index out of range
2025-08-14 03:51:09,636 - ERROR - Error in run 0
Traceback (most recent call last):
  File "/home/s2516027/GLCE/DyGMamba/train_ccasf_link_prediction.py", line 420, in main
    results, model = train_model(config, logger)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s2516027/GLCE/DyGMamba/train_ccasf_link_prediction.py", line 315, in train_model
    val_auc, val_ap = evaluate_model(model, val_data, config, logger, "validation")
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s2516027/GLCE/DyGMamba/train_ccasf_link_prediction.py", line 224, in evaluate_model
    neg_result = model.compute_src_dst_node_temporal_embeddings(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s2516027/GLCE/DyGMamba/models/DyGMamba.py", line 143, in compute_src_dst_node_temporal_embeddings
    self.neighbor_sampler.get_all_first_hop_neighbors(node_ids=dst_node_ids, node_interact_times=node_interact_times)
  File "/home/s2516027/GLCE/DyGMamba/utils/utils.py", line 271, in get_all_first_hop_neighbors
    node_neighbor_ids, node_edge_ids, node_neighbor_times, _ = self.find_neighbors_before(node_id=node_id,
                                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s2516027/GLCE/DyGMamba/utils/utils.py", line 145, in find_neighbors_before
    i = np.searchsorted(self.nodes_neighbor_times[node_id], interact_time)
                        ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
IndexError: list index out of range
