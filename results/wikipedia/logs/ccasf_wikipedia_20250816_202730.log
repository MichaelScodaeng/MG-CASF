2025-08-16 20:27:30,444 - INFO - Starting experiment: ccasf_cross_attention on wikipedia
2025-08-16 20:27:30,444 - INFO - Device: cuda
2025-08-16 20:27:30,444 - INFO - 
==================================================
2025-08-16 20:27:30,444 - INFO - Run 1/1 - DyRep with cross_attention
2025-08-16 20:27:30,444 - INFO - ==================================================
2025-08-16 20:27:30,447 - INFO - Starting training for wikipedia with C-CASF
2025-08-16 20:27:30,447 - INFO - Configuration: {'dataset_name': 'wikipedia', 'model_name': 'DyRep', 'use_ccasf': True, 'spatial_dim': 64, 'temporal_dim': 64, 'ccasf_output_dim': 128, 'node_feat_dim': 172, 'edge_feat_dim': 172, 'fusion_method': 'cross_attention', 'weighted_fusion_learnable': True, 'mlp_hidden_dim': None, 'mlp_num_layers': 2, 'cross_attn_heads': 8, 'use_rpearl': True, 'use_enhanced_lete': True, 'rpearl_k': 16, 'rpearl_mlp_layers': 2, 'rpearl_hidden': 64, 'lete_p': 0.5, 'lete_layer_norm': True, 'lete_scale': True, 'time_feat_dim': 100, 'channel_embedding_dim': 100, 'patch_size': 2, 'num_layers': 2, 'num_heads': 2, 'dropout': 0.1, 'gamma': 0.5, 'max_input_sequence_length': 64, 'max_interaction_times': 10, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'patience': 20, 'num_epochs': 3, 'batch_size': 200, 'eval_batch_size': 200, 'test_batch_size': 200, 'val_ratio': 0.15, 'test_ratio': 0.15, 'negative_sample_strategy': 'random', 'num_neighbors': 20, 'num_runs': 1, 'load_best_configs': False, 'device': 'cuda', 'num_workers': 8, 'seed': 0, 'data_root': '/home/s2516027/GLCE/processed_data', 'output_root': '/home/s2516027/GLCE/results', 'checkpoint_dir': '/home/s2516027/GLCE/checkpoints', 'log_every': 1, 'eval_every': 5, 'save_model': True, 'verbose': True}
2025-08-16 20:27:30,448 - INFO - Loading wikipedia dataset...
2025-08-16 20:27:30,856 - INFO - Number of nodes: 9228
2025-08-16 20:27:30,856 - INFO - Number of edges: 157475
2025-08-16 20:27:30,856 - INFO - Node feature dimension: 172
2025-08-16 20:27:30,856 - INFO - Edge feature dimension: 172
2025-08-16 20:27:30,856 - INFO - Training interactions: 79202
2025-08-16 20:27:30,856 - INFO - Validation interactions: 23621
2025-08-16 20:27:30,856 - INFO - Test interactions: 23621
2025-08-16 20:27:31,365 - INFO - Creating model: DyRep
2025-08-16 20:27:31,626 - INFO - Wrapping DyRep with C-CASF
2025-08-16 20:27:31,627 - INFO - Model created with 1188825 parameters
2025-08-16 20:27:31,634 - INFO - Sorted training data by timestamp for memory-based model DyRep
2025-08-16 20:32:06,370 - INFO - save model /home/s2516027/GLCE/checkpoints/wikipedia/models/DyRep/DyRep_cross_attention_seed0.pkl
2025-08-16 20:32:07,948 - INFO - Non-parametric data (memory_bank.node_raw_messages) saved to /home/s2516027/GLCE/checkpoints/wikipedia/models/DyRep/DyRep_cross_attention_seed0_nonparametric_data.pkl
2025-08-16 20:32:08,056 - INFO - Saved best model to /home/s2516027/GLCE/checkpoints/wikipedia/best_models/best_DyRep_cross_attention_wikipedia.pth
2025-08-16 20:32:08,056 - INFO - Epoch   0/3 | Loss: 0.6417 | Time: 276.39s
2025-08-16 20:35:55,410 - INFO - Epoch   1/3 | Loss: 0.5922 | Time: 227.35s
2025-08-16 20:40:30,419 - INFO - Epoch   2/3 | Loss: 0.5817 | Time: 275.01s
2025-08-16 20:40:30,420 - INFO - Training completed in 778.75s
2025-08-16 20:40:30,420 - INFO - Final evaluation...
2025-08-16 20:40:30,822 - ERROR - Error in run 0
Traceback (most recent call last):
  File "/home/s2516027/GLCE/DyGMamba/train_ccasf_link_prediction.py", line 901, in main
    results, model = train_model(config, logger)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s2516027/GLCE/DyGMamba/train_ccasf_link_prediction.py", line 746, in train_model
    val_losses, val_metrics = evaluate_model_link_prediction(model_name=getattr(config, 'model_name', 'DyGMamba_CCASF'),
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s2516027/GLCE/DyGMamba/evaluate_models_utils.py", line 89, in evaluate_model_link_prediction
    model[0].compute_src_dst_node_temporal_embeddings(src_node_ids=batch_neg_src_node_ids,
  File "/home/s2516027/GLCE/DyGMamba/models/ccasf_wrapper.py", line 78, in compute_src_dst_node_temporal_embeddings
    result = self._compute_backbone_embeddings(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s2516027/GLCE/DyGMamba/models/ccasf_wrapper.py", line 136, in _compute_backbone_embeddings
    return self.backbone_model.compute_src_dst_node_temporal_embeddings(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s2516027/GLCE/DyGMamba/models/MemoryModel.py", line 108, in compute_src_dst_node_temporal_embeddings
    updated_node_memories, updated_node_last_updated_times = self.get_updated_memories(node_ids=np.array(range(self.num_nodes)),
                                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s2516027/GLCE/DyGMamba/models/MemoryModel.py", line 187, in get_updated_memories
    updated_node_memories, updated_node_last_updated_times = self.memory_updater.get_updated_memories(unique_node_ids=unique_node_ids,
                                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s2516027/GLCE/DyGMamba/models/MemoryModel.py", line 475, in get_updated_memories
    assert (self.memory_bank.get_node_last_updated_times(unique_node_ids=unique_node_ids) <=
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Trying to update memory to time in the past!
